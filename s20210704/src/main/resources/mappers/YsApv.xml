<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.oracle.s20210704.dao.YsApvDao">
	<select id="ysRcvTotal" parameterType="int" resultType="int">
		select count(*)
		from apv a,apv_mid m,emp e
		where a.apv_mid = m.apv_mid
		and a.apv_snd = e.emp_num 
		and (m.apv_mid_emp = #{rcv_num} or a.apv_fnl = #{rcv_num})
	</select>
	<select id="ysApvRcvList" parameterType="com.oracle.s20210704.model.YsApv" resultType="com.oracle.s20210704.model.YsApv">
		select * 
		from (select rownum rn, b.* 
		      from (select a.*,m.apv_mid_ok,m.apv_mid_num,e.emp_name as srt_name 
		      		from apv a,apv_mid m,emp e
					where a.apv_mid = m.apv_mid
					and a.apv_snd = e.emp_num 
					and (m.apv_mid_emp = #{apv_mid_emp} or a.apv_fnl = #{apv_mid_emp})
					order by m.apv_mid_ok,a.apv_ok,a.apv_date desc
		            ) b
		      )
		where rn between #{start} and #{end}
	</select>
	<select id="ysSndTotal" parameterType="int" resultType="int">
		select count(*)
		from apv a,apv_mid m,emp e
		where a.apv_mid = m.apv_mid
		and a.apv_snd = e.emp_num
		and a.apv_snd = #{snd_num}
	</select>
	<select id="ysApvSndList" parameterType="com.oracle.s20210704.model.YsApv" resultType="com.oracle.s20210704.model.YsApv">
		select * 
		     from (select rownum rn, b.* 
		          from (select a.*,m.apv_mid_ok,m.apv_mid_num,e.emp_name as srt_name
		                from apv a,apv_mid m,emp e
		                where a.apv_mid = m.apv_mid
		                and a.apv_snd = e.emp_num
		                and a.apv_snd = #{apv_snd}
		               ) b
		           )
		where rn between #{start} and #{end}
	</select>
</mapper>